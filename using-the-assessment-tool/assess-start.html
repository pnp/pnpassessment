<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Start an assessment | Microsoft 365 Assessment Tool </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Start an assessment | Microsoft 365 Assessment Tool ">
    <meta name="generator" content="docfx 2.56.5.0">
    <meta name="description" content="The Microsoft 365 SharePoint Assessment tool is enabling various deprecation and adoption scenarios by enabling you to assess your tenant.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <!--
        <a class="navbar-brand" href="../index.html">
          <img id="logo" class="svg" src="../logo.svg" alt="" >
        </a>
        -->
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/pnpassessment/blob/main/docs/using-the-assessment-tool/assess-start.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="start-an-assessment">Start an assessment</h1>

<p>If you want to use the Microsoft 365 Assessment tool for a particular adoption or deprecation assessment you need to use <a href="assess.html">the Microsoft 365 Assessment tool CLI</a> to start the assessment. When starting an assessment you can provide input that defines how authentication will happen, input specific for the assessment you're running and generic configuration input.</p>
<h2 id="sample-assessment-start-commands">Sample assessment start commands</h2>
<p>Before diving into all the possible command line arguments let's first show some typical use cases:</p>
<table>
<thead>
<tr>
<th>Task</th>
<th>CLI</th>
</tr>
</thead>
<tbody>
<tr>
<td>Start a new Syntex full assessment (application permissions) for a complete tenant</td>
<td>microsoft365-assessment.exe start --mode syntex --authmode application <br> --tenant bertonline.sharepoint.com --applicationid c545f9ce-1c11-440b-812b-0b35217d9e83 <br> --certpath &quot;My|CurrentUser|b133d1cb4d19ce539986c7ac67de005481084c84&quot; <br> --syntexfull</td>
</tr>
<tr>
<td>Start a new Syntex assessment (delegated permissions) for a set of site collections</td>
<td>microsoft365-assessment.exe start --mode Syntex --authmode interactive <br> --tenant bertonline.sharepoint.com <br> --siteslist &quot;https://bertonline.sharepoint.com/sites/ussales,https://bertonline.sharepoint.com/sites/europesales&quot;</td>
</tr>
</tbody>
</table>
<h2 id="command-line-arguments">Command line arguments</h2>
<p>The easiest way to see all possible command line arguments for a command (e.g. for <code>start</code>) is using the <code>--help</code> parameter.</p>
<p><img src="../images/startargumentshelp.png" alt="start argument overview"></p>
<p>In the next chapters the arguments are described in more details, grouped by category</p>
<h2 id="assessment-mode">Assessment mode</h2>
<p>The main argument to use is the <code>--mode</code> argument that enables you to pick the assessment to run. This argument is required and when not specified it defaults to <code>Syntex</code>. Overtime more assessment modules will be added.</p>
<h2 id="assessment-scope">Assessment scope</h2>
<p>When running an assessment you do have the option to scope the assessment to either the complete tenant or a set of site collections. When running an assessment for all site collections in your tenant then you have to specify the required <code>--tenant</code> argument. Some samples are: <code>--tenant bertonline.sharepoint.com</code> or <code>--tenant sites.contoso.com</code> in case you're using vanity URLs. If you want to limit the assessment to one or more site collections then you additionally can add either the <code>--siteslist</code> argument or the <code>--sitesfile</code> argument.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>When you're using a vanity URL tenant you also need to either use the <code>--sitesfile</code> or <code>--siteslist</code> arguments when <a href="assess-start.html">starting a new assessment</a>. Enumerating all site collections in a vanity URL tenant will be added in a future release.</p>
</div>
<h3 id="scoping-via---siteslist">Scoping via <code>--siteslist</code></h3>
<p>When using the <code>--siteslist</code> argument you can on the command line provided a comma delimited list of site collections that will have to be assessed. A sample: <code>--siteslist &quot;https://bertonline.sharepoint.com/sites/ussales,https://bertonline.sharepoint.com/sites/europesales,https://bertonline.sharepoint.com/sites/apacsales&quot;</code>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>You cannot combine both <code>--siteslist</code> and <code>--sitesfile</code>.</p>
</div>
<h3 id="scoping-via---sitesfile">Scoping via <code>--sitesfile</code></h3>
<p>While above <code>--siteslist</code> option is convenient it becomes hard to use when you want to scope to tens or hundreds of site collections. For that purpose the <code>--sitesfile</code> argument is a better solution. You simply point the Microsoft 365 Assessment tool to a text file containing the site collection URLs to assess. A sample: <code>--sitesfile &quot;C:\Microsoft365AssessmentTool\sites.txt&quot;</code>. The text file itself is just a list of site URLs:</p>
<pre><code class="lang-text">https://bertonline.sharepoint.com/sites/ussales
https://bertonline.sharepoint.com/sites/europesales
https://bertonline.sharepoint.com/sites/apacsales
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>You cannot combine both <code>--siteslist</code> and <code>--sitesfile</code>.</p>
</div>
<h2 id="authentication-configuration">Authentication configuration</h2>
<p>The main authentication argument to use the <code>--authmode</code> argument that allows you to choose how the Microsoft 365 Assessment tool will authenticate to your tenant. Possible values are:</p>
<table>
<thead>
<tr>
<th>Authentication mode</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Application</code></td>
<td>Use this mode if you want to use application permissions. This assumes you've <a href="setupauth.html">configured an Azure AD application</a> to support application permissions. You'll need to specify the certificate to use for authentication via either the <code>--certpath</code> argument or use the <code>--certfile</code> and <code>--certpassword</code> arguments.</td>
</tr>
<tr>
<td><code>Interactive</code></td>
<td>Use this mode if you want to use delegated permissions and you're using a Windows or macOS computer. This assumes you've <a href="setupauth.html">configured an Azure AD application</a> to support delegated permissions. When you use this mode a browser window will be opened asking you to authenticate.</td>
</tr>
<tr>
<td><code>Device</code></td>
<td>Use this mode if you want to use delegated permissions and you're using a Linux computer. This assumes you've <a href="setupauth.html">configured an Azure AD application</a> to support delegated permissions. When using this mode you'll see a code on the command line which you'll need to use at <a href="https://aka.ms/devicelogin">https://aka.ms/devicelogin</a> to complete the authentication flow.</td>
</tr>
</tbody>
</table>
<h3 id="defining-the-azure-ad-application-to-use-via---applicationid">Defining the Azure AD application to use via <code>--applicationid</code></h3>
<p>As mentioned in the <a href="setupauth.html">configure authentication</a> page it's recommended to create an Azure AD application. To tell the Microsoft 365 Assessment tool which Azure AD application it should use you need to specify the Azure AD application id via the <code>--applicationid</code> argument. A sample: <code>--applicationid c545f9ce-1c11-440b-812b-0b35217d9e83</code>. When you do not specify an Azure AD application id the PnP Management Shell application is used (<code>31359c7f-bd7e-475c-86db-fdb8c937548e</code>).</p>
<h3 id="specifying-the-certificate-to-use-when-using-application-permissions">Specifying the certificate to use when using application permissions</h3>
<p>When you've chosen to use application permissions you need to tell the Microsoft 365 Assessment tool the certificate it needs to use for authentication. Two modes are supported: you either point to a certificate already stored in a certificate store on your computer (<code>--certpath</code>) or you point to a PFX file containing the certificate (<code>--certfile</code>). When using a PFX file you also need to specify the password to open the file via <code>--certpassword</code>.</p>
<p>When using <code>--certpath</code> some additional information is needed to understand how the <code>--certpath</code> argument (e.g. <code>My|CurrentUser|b133d1cb4d19ce539986c7ac67de005481084c84</code>) needs to be defined. You typically use the <code>My</code> or <code>Root</code> store names followed by either <code>CurrentUser</code> or <code>LocalMachine</code> to identify the location of the certificate store on your computer. The last part is the thumbprint of the certificate you want to use.</p>
<div class="NOTE">
<h5>Note</h5>
<p>If you're using the <code>LocalMachine</code> store location then be aware that you'll need to ensure the user running the Microsoft 365 Assessment tool has permissions to read the certificate private key in the <code>LocalMachine</code> store. You can do this by granting the account you're using to run the Microsoft 365 Assessment tool permissions to read the private key by opening up the local machine certificate console (<code>certlm.msc</code>), navigating to the certificate you're using, right click on the certificate, choose <code>All Tasks -&gt; Manage private keys...</code> and add your user account with read permissions.</p>
</div>
<h3 id="clearing-the-authentication-cache">Clearing the authentication cache</h3>
<p>When using delegated permissions in combination with either <code>--authmode</code> equal to <code>Interactive</code> or <code>Device</code> then you're seeing a one time prompt for credentials when you use this option for the first time. As part of this operation the authentication library (MSAL) state is cached on disk using machine/user specific encryption. With this cache the Microsoft 365 Assessment tool can automatically request new access tokens whenever that's needed. If you're however switching between tenants or you want to remove this stored cache you can do so via the <code>cache</code> action. Sample: <code>microsoft365-assessment.exe cache --clearauthentication</code>.</p>
<div class="NOTE">
<h5>Note</h5>
<p>An alternative way of clearing this cache is by deleting the <code>msalcache.bin</code> file inside the folder hosting <code>microsoft365-assessment.exe</code>.</p>
</div>
<h2 id="other-configuration-options">Other configuration options</h2>
<p>Depending on the chosen assessment mode (<code>--mode</code> argument) you can optionally define extra arguments.</p>
<h3 id="sharepoint-syntex-adoption-assessment">SharePoint Syntex adoption assessment</h3>
<p>When running this assessment it's recommended to use the <code>--syntexfull</code> argument, adding this argument will make the assessment use search to gather exact file counts per content type and retention label counts. This however also requires that your Azure AD application is correctly configured to allow this. See the specific <a href="../sharepoint-syntex/requirements.html">SharePoint Syntex assessment page</a> to learn more.</p>
<h3 id="parallel-operations">Parallel operations</h3>
<p>By default the Microsoft 365 Assessment tool will use multiple parallel operations to read data from your tenant. By default one operation per logical processor is used with a maximum of 10, but you can change this number via the <code>--threads</code> argument.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>Running too many parallel operations will make it more likely the assessment will be throttled. Using between 4 and 8 threads is a good starting point.</p>
</div>
<h2 id="running-multiple-parallel-assessments">Running multiple parallel assessments</h2>
<p>The Microsoft 365 Assessment tool supports running up to 3 parallel assessments, but do note that just like with bumping up the amount of parallel operations this will increase the likelihood of getting throttled.</p>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Microsoft 365 Assessment Tool<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>